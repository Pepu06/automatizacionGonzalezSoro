{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 130, "column": 0}, "map": {"version":3,"sources":["file:///Users/pedro/Documents/gonzalezSoro_automatizacion/app/api/busca_id.js"],"sourcesContent":["import { google } from \"googleapis\";\n\nexport async function obtenerSpreadsheetId(nombreDepartamento) {\n  const auth = new google.auth.GoogleAuth({\n    credentials: JSON.parse(process.env.GOOGLE_CREDENTIALS),\n    scopes: [\n      \"https://www.googleapis.com/auth/drive\",\n      \"https://www.googleapis.com/auth/spreadsheets\"\n    ]\n  });\n\n  const drive = google.drive({ version: \"v3\", auth });\n\n  const res = await drive.files.list({\n    q: `\n      mimeType='application/vnd.google-apps.spreadsheet'\n      and name='${nombreDepartamento}'\n      and trashed=false\n    `,\n    fields: \"files(id, name)\",\n  });\n\n  if (res.data.files.length === 0) {\n    throw new Error(\"No se encontró el spreadsheet del departamento\");\n  }\n\n  return res.data.files[0].id;\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,qBAAqB,kBAAkB;IAC3D,MAAM,OAAO,IAAI,+JAAM,CAAC,IAAI,CAAC,UAAU,CAAC;QACtC,aAAa,KAAK,KAAK,CAAC,QAAQ,GAAG,CAAC,kBAAkB;QACtD,QAAQ;YACN;YACA;SACD;IACH;IAEA,MAAM,QAAQ,+JAAM,CAAC,KAAK,CAAC;QAAE,SAAS;QAAM;IAAK;IAEjD,MAAM,MAAM,MAAM,MAAM,KAAK,CAAC,IAAI,CAAC;QACjC,GAAG,CAAC;;gBAEQ,EAAE,mBAAmB;;IAEjC,CAAC;QACD,QAAQ;IACV;IAEA,IAAI,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,KAAK,GAAG;QAC/B,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO,IAAI,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,EAAE;AAC7B"}},
    {"offset": {"line": 171, "column": 0}, "map": {"version":3,"sources":["file:///Users/pedro/Documents/gonzalezSoro_automatizacion/app/api/maestro/route.js"],"sourcesContent":["import { google } from \"googleapis\";\nimport { obtenerSpreadsheetId } from \"../busca_id.js\"; \nimport { NextResponse } from \"next/server\";\n\nexport async function GET() {\n  // Verificación de credenciales en consola del servidor\n  console.log(\"Credenciales cargadas:\", process.env.GOOGLE_CREDENTIALS ? \"SÍ\" : \"NO\");\n\n  const MAESTRO_SPREADSHEET_ID = \"1usBD--9MjH-u1Eg5zCHb_TCmlb2h1SHP5uhzsdxEFqQ\";\n\n  const auth = new google.auth.GoogleAuth({\n    credentials: JSON.parse(process.env.GOOGLE_CREDENTIALS),\n    scopes: [\"https://www.googleapis.com/auth/spreadsheets\", \"https://www.googleapis.com/auth/drive\"]\n  });\n  \n  const sheets = google.sheets({ version: \"v4\", auth });\n\n  try {\n    const response = await sheets.spreadsheets.values.get({\n      spreadsheetId: MAESTRO_SPREADSHEET_ID,\n      range: \"CONFIG!A2:A\",\n    });\n\n    const nombres = response.data.values;\n    if (!nombres || nombres.length === 0) {\n      return NextResponse.json({ message: \"No se encontraron nombres\" });\n    }\n\n    const filasParaEscribir = [];\n\n    for (const fila of nombres) {\n      const nombreDept = fila[0];\n      try {\n        const id = await obtenerSpreadsheetId(nombreDept);\n        const link = `https://docs.google.com/spreadsheets/d/${id}/`;\n        filasParaEscribir.push([link]);\n      } catch (error) {\n        filasParaEscribir.push([\"LINK NO ENCONTRADO\"]);\n      }\n    }\n\n    await sheets.spreadsheets.values.update({\n      spreadsheetId: MAESTRO_SPREADSHEET_ID,\n      range: \"CONFIG!B2\",\n      valueInputOption: \"RAW\",\n      requestBody: { values: filasParaEscribir },\n    });\n\n    return NextResponse.json({ message: \"Hoja CONFIG actualizada con éxito\" });\n\n  } catch (error) {\n    console.error(error);\n    return NextResponse.json({ error: error.message }, { status: 500 });\n  }\n}"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe;IACpB,uDAAuD;IACvD,QAAQ,GAAG,CAAC,0BAA0B,QAAQ,GAAG,CAAC,kBAAkB,GAAG,OAAO;IAE9E,MAAM,yBAAyB;IAE/B,MAAM,OAAO,IAAI,+JAAM,CAAC,IAAI,CAAC,UAAU,CAAC;QACtC,aAAa,KAAK,KAAK,CAAC,QAAQ,GAAG,CAAC,kBAAkB;QACtD,QAAQ;YAAC;YAAgD;SAAwC;IACnG;IAEA,MAAM,SAAS,+JAAM,CAAC,MAAM,CAAC;QAAE,SAAS;QAAM;IAAK;IAEnD,IAAI;QACF,MAAM,WAAW,MAAM,OAAO,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC;YACpD,eAAe;YACf,OAAO;QACT;QAEA,MAAM,UAAU,SAAS,IAAI,CAAC,MAAM;QACpC,IAAI,CAAC,WAAW,QAAQ,MAAM,KAAK,GAAG;YACpC,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAA4B;QAClE;QAEA,MAAM,oBAAoB,EAAE;QAE5B,KAAK,MAAM,QAAQ,QAAS;YAC1B,MAAM,aAAa,IAAI,CAAC,EAAE;YAC1B,IAAI;gBACF,MAAM,KAAK,MAAM,IAAA,gJAAoB,EAAC;gBACtC,MAAM,OAAO,CAAC,uCAAuC,EAAE,GAAG,CAAC,CAAC;gBAC5D,kBAAkB,IAAI,CAAC;oBAAC;iBAAK;YAC/B,EAAE,OAAO,OAAO;gBACd,kBAAkB,IAAI,CAAC;oBAAC;iBAAqB;YAC/C;QACF;QAEA,MAAM,OAAO,YAAY,CAAC,MAAM,CAAC,MAAM,CAAC;YACtC,eAAe;YACf,OAAO;YACP,kBAAkB;YAClB,aAAa;gBAAE,QAAQ;YAAkB;QAC3C;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAoC;IAE1E,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC;QACd,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACnE;AACF"}}]
}